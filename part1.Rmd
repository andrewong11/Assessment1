---
title: "AssessmentPart1"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```



```{r Embedding Map generated by QGIS}
library(knitr)
knitr::include_graphics('afghan_latest.jpg')
```

#### Start of assessment

```{r R generation of Map}
library(plotly)
library(maptools)
library(RColorBrewer)
library(classInt)
library(OpenStreetMap)
library(rJava)
library(OpenStreetMap)
library(sp)
library(rgeos)
library(tmap)
library(tmaptools)
library(sf)
library(rgdal)
library(geojsonio)
library(ggplot2)
library(shiny)
library(shinyjs)
library(dplyr)
library(tidyverse)


# Reading shapefile into R
afghanmap <- read_shape("sdr_subnational_data_dhs_2015.shp", as.sf = TRUE)
afghan_lowelec <- afghanmap %>% filter(HCELECHELC<50)

# Making maps
install.packages("PBSmapping")

afghan_osm <- read_osm(afghanmap, type = "esri", zoom = NULL)

library(maps)
library(PBSmapping)
library(leaflet)
library(sf)
library(sp)
library(magrittr)


##### Plotting with TMAP #####
tmap_mode("plot")
tm_shape(afghanmap) +
  tm_polygons("EDLITRWLIT",
             style = "jenks",
             palette = "YlOrBr",
             midpoint = NA,
             border.col = "black",
             border.lwd = 0.5,
             title = "Female literacy (%)") +
  tm_text("DHSREGEN", size = 0.4, col = "black") +
tm_shape(afghan_lowelec) +
  tm_fill("HCELECHELC", alpha = 1, title = "Households with electricity") +
  tm_borders(col="black",lwd=2.0) +
  tm_text("DHSREGEN", size = 0.4, col = "black")


##### Plotting with LEAFLET #####

afghanmapSP <- afghanmap %>%
  st_transform(crs = 4326) %>%
  as("Spatial")

pal <- colorBin(palette = "YlOrRd", 
                domain = afghanmapSP$EDLITRWLIT)

leaflet(afghanmapSP) %>%
  addPolygons(stroke = FALSE, 
              fillOpacity = 0.5, 
              smoothFactor = 0.5,
              color = ~pal(EDLITRWLIT),
              popup = ~DHSREGEN
  ) %>%
  addProviderTiles("CartoDB.DarkMatter") %>%
  addLegend("bottomright", 
            pal= pal, 
            values = ~EDLITRWLIT, 
            title = "Female Literacy rates(%)", 
            opacity = 1
  )
